{{- if .Values.resourceQuota.enabled -}}
apiVersion: v1
kind: ResourceQuota
metadata:
  name: {{ include "tfy-agent.fullname" . }}-critical-pods
  labels:
    {{- include "tfy-agent.labels" . | nindent 4 }}
  {{- with include "tfy-agent.annotations" . }}
  annotations:
    {{- . | nindent 4 }}
  {{- end }}
spec:
  scopeSelector:
    matchExpressions:
    - operator: In
      scopeName: PriorityClass
      values:
      {{- with .Values.resourceQuota.priorityClasses }}
      {{- toYaml . | nindent 8 }}
      {{- end }}
{{- end }}
